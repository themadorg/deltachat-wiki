---
title: سیاست عدم ثبت لاگ
description: جزئیات فنی نحوه اجرای سیاست «بدون لاگ» در Madmail با اولویت حریم خصوصی.
category: فنی
---

# سیاست عدم ثبت لاگ (No Log Policy)

## نمای کلی
Chatmail با رویکردی قوی در اولویت‌دهی به حریم خصوصی طراحی شده است. این سیاست تضمین می‌کند که هیچ لاگ پایداری شامل متادیتای حساس (آدرس فرستنده/گیرنده، مُهرهای زمانی، تلاش‌های احراز هویت) در هنگام فعال بودن این سیاست در سرور ذخیره نشود.

## اجرای فنی

### پیکربندی عمومی
ثبت لاگ را می‌توان به‌صورت عمومی در فایل `maddy.conf` با استفاده از دستورالعمل `log` غیرفعال کرد:
```hcl
log off
```
هنگامی که روی `off` تنظیم شود، سرور از یک بک‌اِند `NopOutput` استفاده می‌کند که تمام رویدادهای لاگ را فوراً دور می‌اندازد. هیچ فایل لاگی ایجاد نمی‌شود و هیچ خروجی به `stderr` یا `syslog` ارسال نمی‌گردد.

### تغییر وضعیت داینامیک لاگ
ثبت لاگ همچنین می‌تواند به‌صورت پویا از طریق دیتابیس تنظیمات تغییر کند. این کار به مدیران اجازه می‌دهد بدون راه‌اندازی مجدد سرویس، ثبت لاگ را متوقف کنند.

- **تغییر وضعیت**:
  ```bash
  maddy creds logging off  # غیرفعال کردن فوری لاگ
  maddy creds logging on   # فعال کردن لاگ (برای اعمال کامل نیاز به ری‌استارت سرویس دارد)
  ```
- **بک‌اِند دیتابیس**: وضعیت در جدول `settings` تحت کلید `__LOG_DISABLED__` ذخیره می‌شود.

### حفاظ‌های حریم خصوصی
۱. **عدم پایداری (Zero Persistence)**: زمانی که ثبت لاگ غیرفعال است، سیستم هیچ فایل هندلی برای اهداف لاگ‌گیری باز نمی‌کند.
۲. **محافظت از متادیتا**: این کار از انباشته شدن سوابق طولانی‌مدت که می‌تواند برای بازسازی الگوهای ارتباطی کاربران استفاده شود، جلوگیری می‌کند.
۳. **فاز بوت**: تنها خطاهای حیاتی مقداردهی اولیه که مانع از شروع کار سرور می‌شوند، در فاز بوت به ژورنال سیستم (stdout/stderr) گزارش می‌شوند. پس از مقداردهی اولیه، سیاست «بدون لاگ» کنترل را به دست می‌گیرد.

## تأیید
برای تأیید اینکه هیچ لاگی تولید نمی‌شود:
- بررسی کنید که مسیر `/var/log/maddy/` (یا دایرکتوری لاگ تنظیم شده شما) خالی باقی بماند.
- دستور `journalctl -u maddy` را اجرا کنید و تأیید کنید که پس از پیام "Listening for incoming connections..." هیچ لاگ رویداد جدیدی ظاهر نمی‌شود.
