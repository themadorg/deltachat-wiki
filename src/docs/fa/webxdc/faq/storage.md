---
title: سؤالات مربوط به ذخیره‌سازی وضعیت برنامه
description: مستندات سؤالات مربوط به ذخیره‌سازی وضعیت برنامه برای webxdc.
category: FAQ
---

# سؤالات مربوط به ذخیره‌سازی وضعیت برنامه

## آیا می‌توانم از localStorage یا IndexedDB در برنامه webxdc خود استفاده کنم؟

بله، می‌توانید از هر دو [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage)
و [IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API) در برنامه خود استفاده کنید
اما از برخی محدودیت‌ها آگاه باشید، [به‌ویژه در حین شبیه‌سازی/توسعه برنامه webxdc](#simdb). <!-- XXX this link was already broken on the master branch, but maybe we can figure out what it was supposed to point to? -->

LocalStorage [محدودیت ۴ تا ۱۰ مگابایت دارد](https://stackoverflow.com/questions/2989284/what-is-the-max-size-of-localstorage-values/) که اگر مراقب نباشید به سرعت پر می‌شود.
IndexedDB جایگزینی است که می‌توانید استفاده کنید و این محدودیت اندازه را ندارد.

توجه داشته باشید که مرورگرها ممکن است پس از مدت طولانی استفاده نکردن از برنامه webxdc، ذخیره‌سازی هم localStorage و هم IndexedDB را بازپس بگیرند.
اگر می‌خواهید داده‌ها را به‌طور ایمن ذخیره کنید،
باید [یک به‌روزرسانی برنامه ارسال کنید](../specification/sendUpdate.html)
که به‌طور ایمن توسط پیام‌رسان ذخیره خواهد شد،
و همچنین امکان استفاده از برنامه در چندین دستگاه را فراهم می‌کند.

## چرا localStorage/IndexedDB با برخی شبیه‌سازهای توسعه کار نمی‌کند؟ {simdb}

وقتی برنامه webxdc خود را با [شبیه‌ساز hello](https://github.com/webxdc/hello) اجرا می‌کنید
همه تب‌های مرورگر یک نمونه localStorage یا indexedDB مشترک دارند
که برخلاف زمانی است که برنامه webxdc شما توسط پیام‌رسان‌ها اجرا می‌شود.
با این حال، [شبیه‌ساز webxdc-dev](https://github.com/webxdc/webxdc-dev)
موفق به جداسازی ذخیره‌سازی برای هر نمونه برنامه webxdc می‌شود
زیرا هر برنامه در حال اجرا از یک پورت localhost جداگانه برای اتصال
به سرور شبیه‌ساز webxdc-dev استفاده می‌کند.

## آیا به‌روزرسانی‌های برنامه تضمین شده به همتاهای چت تحویل داده می‌شوند؟

خیر، هیچ تحویل پیام تضمین شده‌ای و همچنین
هیچ بازخوردی درباره وضعیت تحویل وجود ندارد.
فقط رویکرد «بهترین تلاش» وجود دارد.
پیام‌رسان‌ها معمولاً پیام‌ها را صف‌بندی می‌کنند و به‌طور مکرر تلاش تحویل می‌کنند.

برنامه‌ها باید فرض کنند که به‌روزرسانی‌ها
ممکن است دوباره مرتب شوند و برخی به‌روزرسانی‌ها از دست بروند.

برای اسناد کوچک، مانند لیست خرید،
ارسال کل وضعیت سند به عنوان یک به‌روزرسانی
هر بار و ادغام اسناد ورودی هنگام دریافت مناسب است.
به این ترتیب تغییرات فقط در صورتی از دست می‌روند
که فرستنده اصلی نتواند
به‌روزرسانی را به هیچ کس دیگری در چت تحویل دهد
و استفاده از برنامه را متوقف کند.

برای اسنادی متشکل از بخش‌های مستقل،
مانند صفحه گسترده متشکل از سلول‌ها،
رویکرد مشابهی می‌تواند به‌طور مستقل
برای هر بخش اعمال شود.

برای برخی برنامه‌ها
مانند بازی‌هایی که تابلوی امتیازات را به‌روزرسانی می‌کنند
ارسال امتیازات بالای جدید
به عنوان به‌روزرسانی فردی خوب است،
زیرا اگر برخی به‌روزرسانی‌ها گم شوند
حیاتی نیست.

اگر اسناد پیچیده‌ای دارید و باید
برای اندازه به‌روزرسانی‌ها بهینه‌سازی کنید
با رمزگذاری تفاوت بین وضعیت‌های سند،
باید یک پروتکل همگام‌سازی خودتان پیاده‌سازی کنید.
مانند تمام موضوعات «همگام‌سازی شبکه» محدودیت‌های نظری وجود دارد.
به‌ویژه مطالعه و فکر کردن درباره
[مسئله دو ژنرال](https://en.wikipedia.org/wiki/Two_Generals'_Problem)
و یادگیری درباره پروتکل‌های «لایه قابلیت اطمینان» موجود
قبل از تلاش برای پیاده‌سازی یکی خودتان مفید است.
