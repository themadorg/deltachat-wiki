---
title: Мессенджер
description: Документация по реализации в мессенджере для webxdc.
category: Спецификация
---

## Реализация в мессенджере для приложений Webxdc

Этот раздел содержит требования и рекомендации для разработчиков мессенджеров по добавлению поддержки запуска и взаимодействия с приложениями webxdc.

Приложения webxdc прикрепляются к сообщению чата в формате [файла-контейнера](./format) и могут быть «запущены» на всех устройствах, получивших это сообщение. Каждое такое сообщение представляет собой отдельный «экземпляр приложения webxdc». Один и тот же файл-контейнер webxdc, отправленный в двух разных сообщениях, будет считаться двумя отдельными приложениями, которые не могут общаться друг с другом или даже знать о существовании друг друга.

### Ограничения WebView

При запуске WebView для приложения webxdc разработчики мессенджеров:

-   ДОЛЖНЫ предоставлять приложению все ресурсы из [файла-контейнера webxdc](./format).
-   При первом открытии ДОЛЖНЫ загружать корневой URL с добавлением `index.html`.
-   ДОЛЖНЫ реализовать [Webxdc Javascript API](api.md) и предоставлять соответствующий файл `webxdc.js`.
-   ДОЛЖНЫ запретить любые формы доступа к Интернету. Если не ограничить доступ, пользователи могут запустить сторонние приложения, которые передадут данные приватного общения внешним сторонам. См. статью [«Bringing E2E privacy to the web»](https://delta.chat/en/2023-05-22-webxdc-security) (на английском), где подробно обсуждаются гарантии приватности в webxdc.
-   ДОЛЖНЫ поддерживать `localStorage`, `sessionStorage` и `indexedDB`.
-   ДОЛЖНЫ изолировать всё хранилище и состояние одного приложения webxdc от любого другого.
-   ДОЛЖНЫ поддерживать события `visibilitychange`.
-   ДОЛЖНЫ поддерживать `window.navigator.language`.
-   ДОЛЖНЫ поддерживать `window.location.href`, но при этом нельзя специфицировать или предполагать что-либо о протоколе (scheme) или доменной части URL.
-   ДОЛЖНЫ поддерживать HTML-ссылки, такие как `<a href="localfile.html">`.
-   ДОЛЖНЫ поддерживать ссылки `mailto`, например `<a href="mailto:addr@example.org?body=...">`.
-   ДОЛЖНЫ поддерживать `<meta name="viewport" ...>`, что особенно важно, так как WebView на разных платформах имеют разные настройки по умолчанию.
-   ДОЛЖНЫ поддерживать `<input type="file">` для импорта файлов; см. статью [`sendToChat()`](../specification/sendToChat) о способах экспорта файлов.

### Взаимодействие в чате

-   Текст из `update.info` ДОЛЖЕН отображаться в чате, и нажатие на него ДОЛЖНО открывать приложение напрямую. Если было установлено свойство `update.href`, то приложение ДОЛЖНО запускаться с корневым URL и переходом по адресу из `update.href`.
-   Самый свежий текст из `update.document` и `update.summary` ДОЛЖЕН отображаться в сообщении webxdc вместе с названием и иконкой. ДОЛЖНА отображаться только одна строка текста (допускается обрезка), так как разработчикам не рекомендуется отправлять сюда длинные тексты.
-   ДОЛЖНА быть кнопка «Запустить» (Start) для запуска приложения. Обратите внимание, что нет необходимости запрашивать согласие на использование куки или обработку данных, так как приложение webxdc технически не может передать данные пользователя в Интернет.

### Примеры реализации в мессенджерах

-   [Delta Chat Android (Java)](https://github.com/deltachat/deltachat-android/blob/master/src/org/thoughtcrime/securesms/WebxdcActivity.java)
-   [Delta Chat iOS (Swift)](https://github.com/deltachat/deltachat-ios/blob/master/deltachat-ios/Controller/WebxdcViewController.swift)
-   [Delta Chat Desktop (TypeScript)](https://github.com/deltachat/deltachat-desktop/blob/786b7514d69ffb723bbe6e706494852a2641bfcd/src/main/deltachat/webxdc.ts)
