---
title: sendToChat
description: Документация функции sendToChat для webxdc.
category: Спецификация
---

# sendToChat

```js
let promise = window.webxdc.sendToChat(message);
```

Функция `sendToChat()` позволяет приложению webxdc подготовить сообщение, которое затем может быть отправлено пользователем в чат. Реализации могут попросить пользователя выбрать чат-получатель и создать сообщение как черновик, чтобы было понятно, что исходящее сообщение является результатом действий пользователя.

`message` — это объект, в котором установлены свойства `file`, `text` или оба:

-   `message.file`: файл для отправки. Укажите `name` и **одно из** следующих свойств: `blob`, `base64` или `plainText`.
    -   `message.file.name`: имя файла, включая расширение.
    -   `message.file.blob`: JavaScript `Blob`, также принимает производные типы, например `File`.
    -   `message.file.base64`: данные в кодировке Base64.
    -   `message.file.plainText`: текст для текстового файла, будет закодирован в UTF-8.
-   `message.text`: текст сообщения для отправки.

Пользователь обычно может отредактировать текст перед отправкой, а также решить отправить только текст без файла или вовсе отменить отправку. Результаты этих действий пользователя не возвращаются обратно в приложение webxdc.

Чтобы пользователь мог сосредоточиться на отправке сообщения, вызов этой функции может передать управление основному приложению и закрыть приложение webxdc. Промис может быть разрешен как до, так и после закрытия.

В случае ошибок приложение не закроется, а промис будет отклонен (rejected).

Пример:

```js
window.webxdc.sendToChat({
    file: {base64: "aGVsbG8=", name: "hello.txt"},
    text: "Этот файл был создан в GreatApp"
}).catch((error) => {
    console.log(error);
});
```

Примечания:

-   Чтобы отправить пустой файл, передайте пустую строку или пустой Blob. Если данные не указаны вовсе, возникнет ошибка. Это важно и для разработчиков мессенджеров: нужно проверять, например, `typeof message.file.base64 === "string"`, а не просто `!message.file.base64`.
-   Для отправки текста не используйте `btoa()`, используйте `message.file.plainText` напрямую, так как у [`btoa()` есть проблемы с символами Unicode и эмодзи](https://developer.mozilla.org/en-US/docs/Web/API/btoa#unicode_strings).
